# åŸç”Ÿæä¾›å‘è¯·æ±‚çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ XMLHttpRequest å’Œ fetch

è¿˜æœ‰ä¸€äº›åŸºäºè¿™ä¸¤ç§è¯·æ±‚å°è£…çš„åº“ï¼Œå¦‚: node-fetchã€axios ç­‰
åœ¨ node å±‚ä¸€èˆ¬å¯ä»¥ä½¿ç”¨ fetchã€node-fetchã€axios

1. XMLHttpRequest
2. fetch

- é»˜è®¤ä¸å¸¦ cookie
- é”™è¯¯ä¸ä¼š reject
- ä¸æ”¯æŒè¶…æ—¶è®¾ç½®

```js
// å¯ä»¥å†™ä¸€ä¸ªé€šç”¨çš„å¼‚æ­¥è¶…æ—¶å‡½æ•° ğŸ”¥
function handlerAsyncTimeout(asyncFn, timeout = 3000) {
  return new Promise((resolve, reject) => {
    asyncFn().then(resolve, reject);
    setTimeout(() => reject, timeout);
  });
}
```

- éœ€è¦å€Ÿç”¨ AbortController ä¸­æ­¢ fetch

# å¸¸è§çš„æµè§ˆå™¨è¯·æ±‚/å“åº”å¤´/é”™è¯¯ç è§£æ

## request header

:method: GET
:path: /solar-comment/api/comment/tutor-primary-activity/senior-recommend/users/self?tagSource=&\_productId=351&\_appId=0
:scheme: https
accept: application/json, text/plain, _/_
accept-encoding: gzip, deflate, br
cache-control: no-cache
cookie: deviceId=c122305d338525616baea870cc76dd5b; abSeed=843447469b71b0978db580220c952c10; userid=172270653; persistent=3411agNdImBJd8GjTW6bWT9Vg0U2yoaka3Lp8sSCiv9B6MDvr27fL4o50ha+Pfuhi1y4/Gg8aRN3FEP+VV4jWA==; sid=5530384168693043754; sess=QvrAQ0Cq+EcDQQPTer2XHlv4fhIRaW/YCb/e4pz/I+vzKp85mI2ukPUBIuGweXj5sq8HhuYQtf03DxK4dphwkOyBKovyUyC5I8t9exQw6Aw=
origin: https://m.yuanfudao.biz
referer: https://m.yuanfudao.biz/primary/market/senior-recommend/reserve
user-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1

## response header

access-control-allow-credentials: true
access-control-allow-origin: https://m.yuanfudao.biz
content-encoding: gzip
content-type: application/json;charset=UTF-8
date: Thu, 06 Aug 2020 08:15:05 GMT
set-cookie: sess=QvrAQ0Cq+EcDQQPTer2XHlv4fhIRaW/YCb/e4pz/I+uSfZtum4dPp9q4HJL5o+GWuDXHXQLQF2JrIgwzZPaZHWal4qYZy/cfW0Sle/fyB/w=;domain=.yuanfudao.biz;path=/;HttpOnly
set-cookie: userid=172270653;domain=.yuanfudao.biz;path=/;HttpOnly
status: 200

## status

200 get æˆåŠŸ
201 post æˆåŠŸ
301 æ°¸ä¹…é‡å®šå‘
302 ä¸´æ—¶é‡å®šå‘
304 åå•†ç¼“å­˜ æœåŠ¡å™¨æ–‡ä»¶æœªä¿®æ”¹
400 å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨è¯†åˆ«
403 æœåŠ¡å™¨å—åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ï¼Œå¯èƒ½æ˜¯è·¨åŸŸ
404 è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨
405 è¯·æ±‚çš„ method ä¸å…è®¸
500 æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯

# å‘é€è¯·æ±‚çš„ç¤ºä¾‹ï¼Œä»¥åŠå°è£…ä¸€ä¸ªå¤šæµè§ˆå™¨å…¼å®¹çš„è¯·æ±‚å‡½æ•°

æ‰‹å†™ä¸€ä¸ª ajax
